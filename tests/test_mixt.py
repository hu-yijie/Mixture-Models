from Mixture_Models import *
from tests import utils


def init_mixt():
    return utils.init_MM(TMM,default_pinwheel_data,10,
    init_params_args={'num_components':3,'scale':0.5},
    expected={'log proportions': [ 0.66579325,  0.35763949, -0.77270015], 'means': [[-0.00419192,  0.31066799],
       [-0.36004278,  0.13275579],
       [ 0.05427426,  0.00214572]], 'sqrt_covs': [np.eye(2),np.eye(2),np.eye(2)],
       'log_dofs': [-0.17460021,  0.43302619,  1.20303737]})

def test_mixt_illustration():
    test_TMM, init_params = init_mixt()
    params_store = utils.check_fit(test_TMM,init_params,"grad_descent",{'learning_rate':0.0005,'mass':0.9,'maxiter':100},
    100,{'likelihood': [-842.09679026, -841.38463545, -840.03406077, -838.11354432,
        -835.68650286, -832.81154   , -829.5427151 , -825.92981013,
        -822.01857716, -817.85095145, -813.46521563, -808.8960997 ,
        -804.17479959, -799.32889379, -794.38213425, -789.35408255,
        -784.25955738, -779.10785282, -773.90168034, -768.6357795 ,
        -763.29513352, -757.85271557, -752.2666775 , -746.47687428,
        -740.40059028, -733.92729774, -726.91224118, -719.16864822,
        -710.45858428, -700.48346037, -688.87886267, -675.23112198,
        -659.17722397, -640.80389683, -622.0934591 , -611.86888659,
        -634.20365716, -624.37494972, -605.47283483, -601.70459577,
        -603.23554422, -604.2860658 , -603.09409701, -599.41796921,
        -593.5661885 , -586.29410129, -579.54802668, -578.10939996,
        -585.58237653, -580.69800503, -570.78838219, -568.8747345 ,
        -568.70015421, -566.65145488, -562.02988187, -555.9432311 ,
        -551.88223229, -553.70258614, -548.21036136, -542.15954825,
        -540.1784544 , -537.2557202 , -531.7553394 , -524.66720469,
        -519.16801052, -514.69805627, -505.88888468, -497.22344172,
        -488.67688361, -478.65508919, -466.16010415, -452.05551965,
        -437.58328586, -421.20777195, -409.92308118, -422.51561304,
        -389.42456718, -380.71624512, -371.52794101, -360.58298518,
        -355.50247252, -362.16845751, -357.66123633, -353.98996943,
        -352.31062242, -350.90974431, -349.29705556, -343.47836812,
        -334.32485994, -324.92570404, -322.21899125, -322.98794471,
        -318.10894167, -319.71313669, -316.45446443, -313.25764462,
        -314.00615175, -312.39411315, -308.32237099, -305.39150095],
 'aic': [1724.19358053, 1722.76927089, 1720.06812154, 1716.22708864,
        1711.37300571, 1705.62308   , 1699.0854302 , 1691.85962026,
        1684.03715433, 1675.70190291, 1666.93043125, 1657.7921994 ,
        1648.34959918, 1638.65778758, 1628.7642685 , 1618.7081651 ,
        1608.51911476, 1598.21570564, 1587.80336069, 1577.27155899,
        1566.59026703, 1555.70543113, 1544.533355  , 1532.95374857,
        1520.80118055, 1507.85459548, 1493.82448237, 1478.33729645,
        1460.91716855, 1440.96692073, 1417.75772535, 1390.46224395,
        1358.35444794, 1321.60779365, 1284.18691819, 1263.73777319,
        1308.40731432, 1288.74989943, 1250.94566967, 1243.40919154,
        1246.47108843, 1248.57213161, 1246.18819401, 1238.83593842,
        1227.132377  , 1212.58820257, 1199.09605336, 1196.21879991,
        1211.16475305, 1201.39601006, 1181.57676439, 1177.749469  ,
        1177.40030842, 1173.30290977, 1164.05976373, 1151.88646221,
        1143.76446459, 1147.40517228, 1136.42072271, 1124.3190965 ,
        1120.35690881, 1114.5114404 , 1103.51067879, 1089.33440938,
        1078.33602105, 1069.39611253, 1051.77776935, 1034.44688345,
        1017.35376723,  997.31017837,  972.32020829,  944.1110393 ,
         915.16657172,  882.4155439 ,  859.84616237,  885.03122609,
         818.84913435,  801.43249023,  783.05588201,  761.16597037,
         751.00494505,  764.33691502,  755.32247266,  747.97993885,
         744.62124483,  741.81948863,  738.59411112,  726.95673623,
         708.64971989,  689.85140808,  684.4379825 ,  685.97588942,
         676.21788335,  679.42627338,  672.90892886,  666.51528924,
         668.01230351,  664.78822629,  656.64474198,  650.7830019 ],
 'bic': [1798.26923002, 1796.84492038, 1794.14377103, 1790.30273814,
        1785.44865521, 1779.69872949, 1773.16107969, 1765.93526975,
        1758.11280382, 1749.7775524 , 1741.00608074, 1731.8678489 ,
        1722.42524867, 1712.73343708, 1702.83991799, 1692.78381459,
        1682.59476425, 1672.29135513, 1661.87901018, 1651.34720848,
        1640.66591653, 1629.78108063, 1618.60900449, 1607.02939806,
        1594.87683005, 1581.93024497, 1567.90013186, 1552.41294594,
        1534.99281804, 1515.04257023, 1491.83337484, 1464.53789345,
        1432.43009743, 1395.68344315, 1358.26256768, 1337.81342268,
        1382.48296382, 1362.82554892, 1325.02131916, 1317.48484103,
        1320.54673793, 1322.6477811 , 1320.26384351, 1312.91158791,
        1301.2080265 , 1286.66385207, 1273.17170285, 1270.2944494 ,
        1285.24040255, 1275.47165955, 1255.65241388, 1251.8251185 ,
        1251.47595791, 1247.37855926, 1238.13541323, 1225.9621117 ,
        1217.84011408, 1221.48082177, 1210.4963722 , 1198.394746  ,
        1194.4325583 , 1188.58708989, 1177.58632828, 1163.41005887,
        1152.41167054, 1143.47176202, 1125.85341884, 1108.52253294,
        1091.42941672, 1071.38582786, 1046.39585778, 1018.18668879,
         989.24222121,  956.49119339,  933.92181186,  959.10687558,
         892.92478384,  875.50813972,  857.13153151,  835.24161986,
         825.08059454,  838.41256451,  829.39812215,  822.05558835,
         818.69689433,  815.89513812,  812.66976062,  801.03238573,
         782.72536938,  763.92705757,  758.513632  ,  760.05153891,
         750.29353284,  753.50192287,  746.98457835,  740.59093874,
         742.087953  ,  738.86387579,  730.72039147,  724.8586514 ]})
    utils.check_labels(test_TMM,default_pinwheel_data,params_store,[2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2,
       2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
       2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
       2, 2, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
       2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0,
       1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
       1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1,
       1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
       1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1,
       1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0])